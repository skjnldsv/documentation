<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Nextcloud Flow &mdash; Nextcloud latest Developer Manual latest documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="JavaScript APIs" href="javascript-apis.html" />
    <link rel="prev" title="Continuous Integration" href="continuous_integration.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/logo-white.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../prologue/index.html">Prologue</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basics/index.html">Basic concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../app_development/index.html">App development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/index.html">Core development</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Digging deeper</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="api.html">API reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="debugging.html">Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="classloader.html">Classloader</a></li>
<li class="toctree-l2"><a class="reference internal" href="continuous_integration.html">Continuous Integration</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Nextcloud Flow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#entities">Entities</a></li>
<li class="toctree-l3"><a class="reference internal" href="#operations">Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-component">Configuration Component</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="javascript-apis.html">JavaScript APIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="npm.html">NPM</a></li>
<li class="toctree-l2"><a class="reference internal" href="notifications.html">Notifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="performance.html">Performance considerations</a></li>
<li class="toctree-l2"><a class="reference internal" href="psr.html">PSR</a></li>
<li class="toctree-l2"><a class="reference internal" href="publicpage.html">Public Pages</a></li>
<li class="toctree-l2"><a class="reference internal" href="repair.html">Repair steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="rest_apis.html">REST APIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="search.html">Search</a></li>
<li class="toctree-l2"><a class="reference internal" href="settings.html">Settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="talk.html">Talk Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="two-factor-provider.html">Two-factor providers</a></li>
<li class="toctree-l2"><a class="reference internal" href="users.html">User management</a></li>
<li class="toctree-l2"><a class="reference internal" href="dashboard.html">Dashboard</a></li>
<li class="toctree-l2"><a class="reference internal" href="projects.html">Projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="groupware/index.html">Groupware integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="web_host_metadata.html">Web Host Metadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="status.html">User Status</a></li>
<li class="toctree-l2"><a class="reference internal" href="security.html">Security</a></li>
<li class="toctree-l2"><a class="reference internal" href="profile.html">Profile</a></li>
<li class="toctree-l2"><a class="reference internal" href="user_migration.html">User migration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../app_publishing_maintenance/index.html">App publishing and maintenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../design/index.html">Nextcloud design guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../html_css_design/index.html">HTML/CSS guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../client_apis/index.html">Clients and Client APIs</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Nextcloud latest Developer Manual</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Digging deeper</a></li>
      <li class="breadcrumb-item active">Nextcloud Flow</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/nextcloud/documentation/edit/master/developer_manual/digging_deeper/flow.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="nextcloud-flow">
<h1>Nextcloud Flow<a class="headerlink" href="#nextcloud-flow" title="Permalink to this headline"></a></h1>
<p>Nextcloud Flow is a user-defined event-based workflow engine.</p>
<p>Applications can expose entities with specific events on the one hand, and operations that act on these events on the other hand. A user defines a workflow rule that is triggered by a certain event which will then execute the operation based on user defined checks.</p>
<p>An example flow might be converting Word documents into PDF when they are added to one folder, then move that Word document to another folder once it’s finished. This workflow would deal with the file entity’s create event and act on that file.</p>
<p>At 36c3 blizzz gave a talk explaining Flow and <a class="reference external" href="https://mirror.eu.oneandone.net/projects/media.ccc.de/congress/2019/h264-sd/36c3-oio-174-eng-Building_Nextcloud_Flow_sd.mp4">how to write actions and triggers.</a> You can <a class="reference external" href="https://nextcloud.com/wp-content/themes/next/assets/files/Building_nextcloud_flow.pdf">find the slides of their talk here.</a></p>
<section id="entities">
<h2>Entities<a class="headerlink" href="#entities" title="Permalink to this headline"></a></h2>
<p>If you want to expose events via Nextcloud Flow, you need to define an entity, which is a class implementing <code class="docutils literal notranslate"><span class="pre">OCP\WorkflowEngine\IEntity</span></code>.</p>
<p>The entity class will expose a name for the User interface via <code class="docutils literal notranslate"><span class="pre">getName()</span></code> and an icon URL <code class="docutils literal notranslate"><span class="pre">getIcon()</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">getEvents()</span></code> method returns an array of all events that this entity can undergo, which will be selectable for the user in the flow interface.</p>
<p>For all events that happen on the nextcloud instance (see <a class="reference internal" href="../basics/events.html#events"><span class="std std-ref">Events</span></a> for all known built-in events), <code class="docutils literal notranslate"><span class="pre">prepareRuleMatcher()</span></code> will be called, so it can check whether this event is one of the ones that the entity makes available in flow.</p>
<p>If that is the case, the entity can assign itself to the rule matcher.</p>
<p>Similarly, <code class="docutils literal notranslate"><span class="pre">isLegitimatedForUserId()</span></code> will check whether the passed user is allowed to see the current event (which requires that you store the event that was passed to <code class="docutils literal notranslate"><span class="pre">prepareRuleMatcher()</span></code>).</p>
</section>
<section id="operations">
<h2>Operations<a class="headerlink" href="#operations" title="Permalink to this headline"></a></h2>
<p>Operations are actions that users can configure to happen when specific events occur.</p>
<p>An operation is a class implementing ISpecificOperation, IOperation or IComplexOperation. Specific operations can only act on one specific entity (e.g. a file), while normal operations can oact on all events. Complex operations do not listen on events but setup their own listener(s).</p>
</section>
<section id="configuration-component">
<h2>Configuration Component<a class="headerlink" href="#configuration-component" title="Permalink to this headline"></a></h2>
<p>The configuration component is what your user sees when they add your flow and go to configure its rules.</p>
<p>For the configuration component, We create a new JavaScript bundle</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ConvertToPdf</span> <span class="kn">from</span> <span class="s1">&#39;./ConvertToPdf&#39;</span> <span class="o">//</span> <span class="n">A</span> <span class="n">Vue</span> <span class="n">component</span>

<span class="n">OCA</span><span class="o">.</span><span class="n">WorkflowEngine</span><span class="o">.</span><span class="n">registerOperator</span><span class="p">({</span>
    <span class="nb">id</span><span class="p">:</span> <span class="s1">&#39;OCA</span><span class="se">\\</span><span class="s1">WorkflowPDFConverter</span><span class="se">\\</span><span class="s1">Operation&#39;</span><span class="p">,</span>
    <span class="n">operation</span><span class="p">:</span> <span class="s1">&#39;keep;preserve&#39;</span><span class="p">,</span>
    <span class="n">options</span><span class="p">:</span> <span class="n">ConvertToPdf</span><span class="p">,</span>
    <span class="n">color</span><span class="p">:</span> <span class="s1">&#39;#dc5047&#39;</span>
<span class="p">})</span>
</pre></div>
</div>
<p>In the <code class="docutils literal notranslate"><span class="pre">RegisterOperationsEvent</span></code> listener we need to registere the above JS bundle.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">OCA.WorkflowEngine.registerOperator</span></code> function tells Nextcloud about your operation, along with the color, and the component that contains configuration specific to your flow.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="continuous_integration.html" class="btn btn-neutral float-left" title="Continuous Integration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="javascript-apis.html" class="btn btn-neutral float-right" title="JavaScript APIs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025 Nextcloud GmbH.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="Versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          <dd><a href="https://docs.nextcloud.com/server/22/developer_manual">22</a></dd>
        
          <dd><a href="https://docs.nextcloud.com/server/23/developer_manual">23</a></dd>
        
          <dd><a href="https://docs.nextcloud.com/server/stable/developer_manual">stable</a></dd>
        
          <dd><a href="https://docs.nextcloud.com/server/latest/developer_manual">latest</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
      </dl>
      <dl>
        
        <dt>On Read the Docs</dt>
          <dd>
            <a href="///projects//?fromdocs=">Project Home</a>
          </dd>
          <dd>
            <a href="///builds//?fromdocs=">Builds</a>
          </dd>
      </dl>
    </div>
  </div>
<script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>