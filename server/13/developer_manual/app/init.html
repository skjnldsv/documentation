

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Navigation and pre-app configuration &mdash; Nextcloud 13 Developer Manual 13 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'13',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="App metadata" href="info.html" />
    <link rel="prev" title="Create an app" href="startapp.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo-white.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../general/index.html">General contributor guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="startapp.html">Create an app</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Navigation and pre-app configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#adding-a-navigation-entry">Adding a navigation entry</a></li>
<li class="toctree-l2"><a class="reference internal" href="#further-pre-app-configuration">Further pre-app configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#best-practice">Best practice</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#appinfo-app-php">appinfo/app.php</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lib-appinfo-application-php">lib/AppInfo/Application.php</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="info.html">App metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="classloader.html">Classloader</a></li>
<li class="toctree-l1"><a class="reference internal" href="request.html">Request lifecycle</a></li>
<li class="toctree-l1"><a class="reference internal" href="routes.html">Routing</a></li>
<li class="toctree-l1"><a class="reference internal" href="middleware.html">Middleware</a></li>
<li class="toctree-l1"><a class="reference internal" href="container.html">Container</a></li>
<li class="toctree-l1"><a class="reference internal" href="controllers.html">Controllers</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">RESTful API</a></li>
<li class="toctree-l1"><a class="reference internal" href="templates.html">Templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="js.html">JavaScript</a></li>
<li class="toctree-l1"><a class="reference internal" href="css.html">CSS</a></li>
<li class="toctree-l1"><a class="reference internal" href="l10n.html">Translation</a></li>
<li class="toctree-l1"><a class="reference internal" href="theming.html">Theming support</a></li>
<li class="toctree-l1"><a class="reference internal" href="schema.html">Database schema</a></li>
<li class="toctree-l1"><a class="reference internal" href="database.html">Database access</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="filesystem.html">Filesystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="appdata.html">AppData</a></li>
<li class="toctree-l1"><a class="reference internal" href="users.html">User management</a></li>
<li class="toctree-l1"><a class="reference internal" href="two-factor-provider.html">Two-factor providers</a></li>
<li class="toctree-l1"><a class="reference internal" href="hooks.html">Hooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="backgroundjobs.html">Background jobs (Cron)</a></li>
<li class="toctree-l1"><a class="reference internal" href="settings.html">Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="migrations.html">Migrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="repair.html">Repair steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="publishing.html">App store publishing</a></li>
<li class="toctree-l1"><a class="reference internal" href="code_signing.html">Code signing</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">App development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../design/index.html">Design guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../android_library/index.html">Android application development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../client_apis/index.html">Client APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/translation.html">Translation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/unit-testing.html">Unit-Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/theming.html">Theming Nextcloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/externalapi.html">External API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/ocs-share-api.html">OCS Share API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/index.html">Core development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bugtracker/index.html">Bugtracker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commun/index.html">Help and communication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Documentation</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Nextcloud 13 Developer Manual</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">App development</a> &raquo;</li>
        
      <li>Navigation and pre-app configuration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/nextcloud/documentation/edit/stable13/developer_manual/app/init.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="navigation-and-pre-app-configuration">
<h1>Navigation and pre-app configuration<a class="headerlink" href="#navigation-and-pre-app-configuration" title="Permalink to this headline">¶</a></h1>
<div class="section" id="adding-a-navigation-entry">
<h2>Adding a navigation entry<a class="headerlink" href="#adding-a-navigation-entry" title="Permalink to this headline">¶</a></h2>
<p>Navigation entries for apps can be created by adding a navigation section to the <code class="file docutils literal"><span class="pre">appinfo/info.xml</span></code> file, containing the name, order and route the navigation entry should link to. For details on the XML schema check the <a class="reference external" href="https://nextcloudappstore.readthedocs.io/en/latest/developer.html#info-xml">app store documentation</a>.</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;navigation&gt;</span>
    <span class="nt">&lt;name&gt;</span>MyApp<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;route&gt;</span>myapp.page.index<span class="nt">&lt;/route&gt;</span>
    <span class="nt">&lt;order&gt;</span>0<span class="nt">&lt;/order&gt;</span>
<span class="nt">&lt;/navigation&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="further-pre-app-configuration">
<h2>Further pre-app configuration<a class="headerlink" href="#further-pre-app-configuration" title="Permalink to this headline">¶</a></h2>
<p>The <code class="file docutils literal"><span class="pre">appinfo/app.php</span></code> is the first file that is loaded and executed in Nextcloud. Depending on the purpose of the app it is usually used to setup things that need to be available on every request to the server, like <a class="reference internal" href="backgroundjobs.html"><span class="doc">Background jobs (Cron)</span></a> and <a class="reference internal" href="hooks.html"><span class="doc">Hooks</span></a> registrations. This is how an example <code class="file docutils literal"><span class="pre">appinfo/app.php</span></code> could look like:</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>

<span class="c1">// execute OCA\MyApp\BackgroundJob\Task::run when cron is called</span>
<span class="nx">\OC</span><span class="o">::</span><span class="nv">$server</span><span class="o">-&gt;</span><span class="na">getJobList</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;OCA\MyApp\BackgroundJob\Task&#39;</span><span class="p">);</span>

<span class="c1">// execute OCA\MyApp\Hooks\User::deleteUser before a user is being deleted</span>
<span class="nx">\OCP\Util</span><span class="o">::</span><span class="na">connectHook</span><span class="p">(</span><span class="s1">&#39;OC_User&#39;</span><span class="p">,</span> <span class="s1">&#39;pre_deleteUser&#39;</span><span class="p">,</span> <span class="s1">&#39;OCA\MyApp\Hooks\User&#39;</span><span class="p">,</span> <span class="s1">&#39;deleteUser&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Although it is also possible to include <a class="reference internal" href="js.html"><span class="doc">JavaScript</span></a> or <a class="reference internal" href="css.html"><span class="doc">CSS</span></a> for other apps by placing the <strong>addScript</strong> or <strong>addStyle</strong> functions inside this file, it is strongly discouraged, because the file is loaded on each request (also such requests that do not return HTML, but e.g. json or webdav).</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>

<span class="nx">\OCP\Util</span><span class="o">::</span><span class="na">addScript</span><span class="p">(</span><span class="s1">&#39;myapp&#39;</span><span class="p">,</span> <span class="s1">&#39;script&#39;</span><span class="p">);</span>  <span class="c1">// include js/script.js for every app</span>
<span class="nx">\OCP\Util</span><span class="o">::</span><span class="na">addStyle</span><span class="p">(</span><span class="s1">&#39;myapp&#39;</span><span class="p">,</span> <span class="s1">&#39;style&#39;</span><span class="p">);</span>  <span class="c1">// include css/style.css for every app</span>
</pre></div>
</div>
</div>
<div class="section" id="best-practice">
<h2>Best practice<a class="headerlink" href="#best-practice" title="Permalink to this headline">¶</a></h2>
<p>A common way to have a cleaner code structure is to create a class Application in <code class="file docutils literal"><span class="pre">lib/AppInfo/Application.php</span></code> that will then execute your setup of hooks or background tasks. You can then just call it in your <code class="file docutils literal"><span class="pre">appinfo/app.php</span></code>. That way you can also make use of Nextclouds dependency injection feature and properly test those methods.</p>
<div class="section" id="appinfo-app-php">
<h3>appinfo/app.php<a class="headerlink" href="#appinfo-app-php" title="Permalink to this headline">¶</a></h3>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>

<span class="nv">$app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\OCA\MyApp\AppInfo\Application</span><span class="p">();</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">registerHooks</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="lib-appinfo-application-php">
<h3>lib/AppInfo/Application.php<a class="headerlink" href="#lib-appinfo-application-php" title="Permalink to this headline">¶</a></h3>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">namespace</span> <span class="nx">OCA\MyApp\AppInfo</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">OCP\AppFramework\App</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Application</span> <span class="k">extends</span> <span class="nx">App</span> <span class="p">{</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">registerHooks</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">\OCP\Util</span><span class="o">::</span><span class="na">connectHook</span><span class="p">(</span><span class="s1">&#39;OC_User&#39;</span><span class="p">,</span> <span class="s1">&#39;pre_deleteUser&#39;</span><span class="p">,</span> <span class="s1">&#39;OCA\MyApp\Hooks\User&#39;</span><span class="p">,</span> <span class="s1">&#39;deleteUser&#39;</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="info.html" class="btn btn-neutral float-right" title="App metadata" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="startapp.html" class="btn btn-neutral float-left" title="Create an app" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021 Nextcloud GmbH.

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: 13
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          <dd><a href="https://docs.nextcloud.com/server/13/developer_manual">13</a></dd>
        
          <dd><a href="https://docs.nextcloud.com/server/14/developer_manual">14</a></dd>
        
          <dd><a href="https://docs.nextcloud.com/server/15/developer_manual">15</a></dd>
        
          <dd><a href="https://docs.nextcloud.com/server/stable/developer_manual">stable</a></dd>
        
          <dd><a href="https://docs.nextcloud.com/server/latest/developer_manual">latest</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
      </dl>
      <dl>
        
        <dt>On Read the Docs</dt>
          <dd>
            <a href="///projects//?fromdocs=">Project Home</a>
          </dd>
          <dd>
            <a href="///builds//?fromdocs=">Builds</a>
          </dd>
      </dl>
    </div>
  </div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
   

</body>
</html>