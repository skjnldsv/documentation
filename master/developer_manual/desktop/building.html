

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" />
  <meta name="readthedocs-addons-api-version" content="1"><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Building the Client &mdash; Nextcloud latest Developer Manual latest documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=8ff6e0db" />
      <link rel="stylesheet" type="text/css" href="../_static/dark_mode_css/general.css?v=c0a7eb24" />
      <link rel="stylesheet" type="text/css" href="../_static/dark_mode_css/dark.css?v=70edf1c7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=f4332903"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
      <script src="../_static/dark_mode_js/default_light.js?v=c2e647ce"></script>
      <script src="../_static/dark_mode_js/theme_switcher.js?v=358d3910"></script>
    <script src="../_static/js/theme.js"></script>
    <script src="../_static/js/versions.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Desktop Clients" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/logo-white.png" class="logo" alt="Logo"/>
          </a>
              <div class="switch-menus">
                <div class="version-switch"></div>
                <div class="language-switch"></div>
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../prologue/index.html">Prologue</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basics/index.html">Basic concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../app_development/index.html">App development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exapp_development/index.html">ExApp development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server/index.html">Server development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../digging_deeper/index.html">Digging deeper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../app_publishing_maintenance/index.html">App publishing and maintenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../design/index.html">Interface &amp; interaction design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../html_css_design/index.html">HTML/CSS guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../client_apis/index.html">Clients and Client APIs</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Desktop Clients</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Building the Client</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#using-github">Using GitHub</a></li>
<li class="toctree-l3"><a class="reference internal" href="#macos-development-build">macOS Development Build</a></li>
<li class="toctree-l3"><a class="reference internal" href="#windows-development-build">Windows Development Build</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#system-requirements">System requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#setting-up-microsoft-visual-studio">Setting up Microsoft Visual Studio</a></li>
<li class="toctree-l4"><a class="reference internal" href="#handling-the-dependencies">Handling the dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="#compiling">Compiling</a></li>
<li class="toctree-l4"><a class="reference internal" href="#windows-installer-i-e-deployment-build-cross-compile">Windows Installer (i.e. Deployment) Build (Cross-Compile)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#generic-build-instructions">Generic Build Instructions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#address-sanitizer">Address Sanitizer</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Nextcloud latest Developer Manual</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Desktop Clients</a></li>
      <li class="breadcrumb-item active">Building the Client</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/nextcloud/documentation/edit/master/developer_manual/desktop/building.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="building-the-client">
<h1>Building the Client<a class="headerlink" href="#building-the-client" title="Link to this heading"></a></h1>
<p>The goal of this section is to set up a build environment for developing
and testing the Nextcloud Desktop client. If you just want to use the
Nextcloud Desktop client without developing and testing it, you should
download the latest stable build instead.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These instructions represent a particular streamlined and easy-to-understand
methodology, but they are by no means the only way of setting up a build
environment.</p>
</div>
<p>The steps listed here have been tested multiple times and should allow you
to build the client and/or the documentation with not warnings or errors.
These instructions should be current with the version, latest, of the
Nextcloud Client with which it ships. If you are using the most recent version
of these instructions, and you run into errors or warnings with the latest
code from the repository, please open a GitHub Issue to let us know so we can
document a workaround or fix any underlying problems.</p>
<section id="using-github">
<h2>Using GitHub<a class="headerlink" href="#using-github" title="Link to this heading"></a></h2>
<p>By default, cloning the GitHub repository will give you the “master” branch,
which is the most recent. If for some reason you want to build an older
version of the Nextcloud Desktop client, you can choose a branch corresponding
with that version. However, for older versions of the client, please be mindful
that any issues present may have been fixed in more recent versions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Doing anything other than just downloading the existing code will
require you to have a GitHub account.</p>
</div>
<p>If your goal in cloning and building the Nextcloud Desktop client is to
contribute to its development, and you are not already a “collaborator”
on the Nextcloud Desktop GitHub repository, you will need to create a “fork”
by clicking the “fork” button in the upper right on any GitHub page in the
repository. It is important to do this in advance because the URL for cloning
the repository is different for a fork than for the main official version.</p>
<p>When cloning a GitHub repository, you have two options for authenticating your
GitHub account, SSH or HTTPS. SSH requires additional setup but is more secure
and simplifies things later on. For an explanation of the differences between
HTTPS and SSH, as well as instructions to set up SSH, see this <a class="reference external" href="https://help.github.com/en/articles/which-remote-url-should-i-use">GitHub
help article</a> on the subject.</p>
<p>The most basic version of the Git command for cloning a repository is as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>&lt;repository_url&gt;
</pre></div>
</div>
<p>Which will clone the repository into the directory where you run the command.</p>
<p>The four versions of the <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">clone</span></code> command are as follows:</p>
<ol class="arabic">
<li><p>HTTPS from the official repository:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/nextcloud/desktop.git
</pre></div>
</div>
</li>
<li><p>SSH from the official repository:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>git@github.com:nextcloud/desktop.git
</pre></div>
</div>
</li>
<li><p>HTTPS from a fork (see above):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/&lt;github_username&gt;/desktop.git
</pre></div>
</div>
</li>
<li><p>SSH from a fork (see above):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>git@github.com:&lt;github_username&gt;/desktop.git
</pre></div>
</div>
</li>
</ol>
</section>
<section id="macos-development-build">
<h2>macOS Development Build<a class="headerlink" href="#macos-development-build" title="Link to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While it is possible to do many of the following steps using GUI
frontends, wherever possible the Terminal commands are listed instead, in order
to streamline the process.</p>
</div>
<ol class="arabic">
<li><p>Install Xcode from the Mac App Store:</p>
<p><a class="reference external" href="https://apps.apple.com/app/xcode/id497799835">https://apps.apple.com/app/xcode/id497799835</a></p>
</li>
</ol>
<p>Then, in Terminal:</p>
<ol class="arabic" start="2">
<li><p>Install Xcode command line tools:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>xcode-select<span class="w"> </span>–install
</pre></div>
</div>
</li>
<li><p>Install Homebrew from <a class="reference external" href="https://brew.sh">brew.sh</a> (which will just give you the following):</p></li>
</ol>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>/bin/bash<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>curl<span class="w"> </span>-fsSL<span class="w"> </span>https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh<span class="k">)</span><span class="s2">&quot;</span>
</pre></div>
</div>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Under certain circumstances, you may get on error along the
lines of <code class="docutils literal notranslate"><span class="pre">Permission</span> <span class="pre">denied</span> <span class="pre">&#64;</span> <span class="pre">apply2files</span></code> when installing certain
Homebrew packages. This is <a class="reference external" href="https://stackoverflow.com/a/63241724">a known issue</a> and can be fixed by changing
the permissions on the affected files with the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>sudo<span class="w"> </span>chown<span class="w"> </span>-R<span class="w"> </span><span class="k">$(</span>whoami<span class="k">)</span>:admin<span class="w"> </span>/usr/local/*<span class="w"> </span><span class="se">\</span>
<span class="w">   </span><span class="o">&amp;&amp;</span><span class="w"> </span>sudo<span class="w"> </span>chmod<span class="w"> </span>-R<span class="w"> </span>g+rwx<span class="w"> </span>/usr/local/*
</pre></div>
</div>
<p>This workaround may lead to other shell warnings.</p>
</div>
<ol class="arabic" start="4">
<li><p>Install Homebrew packages:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>brew<span class="w"> </span>install<span class="w"> </span>git<span class="w"> </span>qt<span class="w"> </span>qtkeychain<span class="w"> </span>cmake<span class="w"> </span>openssl<span class="w"> </span>glib<span class="w"> </span>cmocka<span class="w"> </span>karchive
</pre></div>
</div>
</li>
<li><p>Certain Homebrew packages are not automatically linked in places where
the build scripts can find them, so you can create a shell-profile script
that will find and load them dynamically when you run a build:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;export QT_PATH=$(brew --prefix qt6)/bin&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.nextcloud_build_variables
%<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;export CMAKE_PREFIX_PATH=$(brew --prefix qt6);$(brew --prefix karchive)&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.nextcloud_build_variables
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The name <code class="docutils literal notranslate"><span class="pre">~/.nextcloud_build_variables</span></code> is just a suggestion for
convenience. You can use a different file or create an entire shell
script, but this way of doing things is the simplest to explain.</p>
</div>
</li>
<li><p>Clone the Nextcloud repository to a convenient location, such as <code class="docutils literal notranslate"><span class="pre">~/Repositories</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>mkdir<span class="w"> </span>~/Repositories
</pre></div>
</div>
<p>(if it doesn’t already exist), then:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>~/Repositories
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The cloned repository can go basically anywhere your user account
has write access, though it should not go in a directory synced with another
cloud service (especially not iCloud Drive). <code class="docutils literal notranslate"><span class="pre">~/Repositories</span></code> is recommended
for tidiness and consistency.</p>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>&lt;repository_url&gt;
</pre></div>
</div>
<p>(See the above section on using GitHub for an explanation of what URL to use.)</p>
</li>
<li><p>Create build directory:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>~/Repositories/desktop
%<span class="w"> </span>mkdir<span class="w"> </span>build
</pre></div>
</div>
</li>
<li><p>Generate the build files:</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<blockquote>
<div><p>By default Nextcloud Desktop will build in a protected directory on macOS,
so you need to specify a build location. You can do this every time you build,
or you can add it to your save build variables, like so:</p>
</div></blockquote>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;export CMAKE_INSTALL_PREFIX=~/Builds&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.nextcloud_build_variables
<span class="c1"># If you want to build a macOS app bundle for distribution</span>
%<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;export BUILD_OWNCLOUD_OSX_BUNDLE=ON&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.nextcloud_build_variables
</pre></div>
</div>
<p>Replace <code class="docutils literal notranslate"><span class="pre">~/Builds</span></code> with a different directory if you’d like the build to end up elsewhere.</p>
</div>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span><span class="nb">source</span><span class="w"> </span>~/.nextcloud_build_variables
%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>~/Repositories/desktop/build
%<span class="w"> </span>cmake<span class="w"> </span>..
</pre></div>
</div>
</div></blockquote>
<ol class="arabic" start="9">
<li><p>Compile and install:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>make<span class="w"> </span>install
</pre></div>
</div>
</li>
</ol>
</section>
<section id="windows-development-build">
<h2>Windows Development Build<a class="headerlink" href="#windows-development-build" title="Link to this heading"></a></h2>
<section id="system-requirements">
<h3>System requirements<a class="headerlink" href="#system-requirements" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Windows 10 or Windows 11</p></li>
<li><p><a class="reference external" href="https://github.com/nextcloud/desktop">The desktop client code</a></p></li>
<li><p>Python 3</p></li>
<li><p>PowerShell</p></li>
<li><p>Microsoft Visual Studio 2022 and tools to compile C++</p></li>
<li><p><a class="reference external" href="https://community.kde.org/Craft">KDE Craft</a></p></li>
</ul>
</section>
<section id="setting-up-microsoft-visual-studio">
<h3>Setting up Microsoft Visual Studio<a class="headerlink" href="#setting-up-microsoft-visual-studio" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p>Click on ‘Modify’ in the Visual Studio Installer:</p></li>
</ol>
<blockquote>
<div><img alt="Visual Studio Installer" src="../_images/visual-studio-installer.png" />
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Select ‘Desktop development with C++’</p></li>
</ol>
<blockquote>
<div><img alt="Desktop development with C++" src="../_images/desktop-development-with-cpp.png" />
</div></blockquote>
</section>
<section id="handling-the-dependencies">
<h3>Handling the dependencies<a class="headerlink" href="#handling-the-dependencies" title="Link to this heading"></a></h3>
<p>We handle the dependencies using <a class="reference external" href="https://community.kde.org/Craft">KDE Craft</a> because it is easy to set it up and it makes the maintenance much more reliable in all platforms.</p>
<ol class="arabic simple">
<li><p>Set up KDE Craft as instructed in <a class="reference external" href="https://community.kde.org/Get_Involved/development/Windows">Get Involved/development/Windows - KDE Community Wiki</a> -  it requires Python 3 and PowerShell.</p></li>
<li><p>After running:</p></li>
</ol>
<div class="highlight-winbatch notranslate"><div class="highlight"><pre><span></span>C<span class="p">:</span><span class="nl">\CraftRoot\craft\craftenv.ps1</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Add the <a class="reference external" href="https://github.com/nextcloud/desktop-client-blueprints">desktop client blueprints</a> - the instructions to handle the client dependencies:</p></li>
</ol>
<div class="highlight-winbatch notranslate"><div class="highlight"><pre><span></span>craft --add-blueprint-repository [git]https://github.com/nextcloud/desktop-client-blueprints.git
craft craft
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Install all client dependencies:</p></li>
</ol>
<div class="highlight-winbatch notranslate"><div class="highlight"><pre><span></span>craft --install-deps nextcloud-client
</pre></div>
</div>
</section>
<section id="compiling">
<h3>Compiling<a class="headerlink" href="#compiling" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p>Make sure your environment variable %PATH% has no conflicting information to the environment you will use to compile the client. For instance, if you have installed OpenSSL previously and have added it to %PATH%, the OpenSSL installed might be a different version than what was installed via KDE Craft.</p></li>
<li><p>Open the Command Prompt (cmd.exe)</p></li>
<li><p>Run:</p></li>
</ol>
<div class="highlight-winbatch notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;C:\Program Files\Microsoft Visual Studio\2022\Community\VC\Auxiliary\Build\vcvarsall.bat&quot;</span> x64
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>To use the tools installed with Visual Studio, you need the following in your %PATH%:</p></li>
</ol>
<blockquote>
<div><img alt="Windows environment variables" src="../_images/path.png" />
</div></blockquote>
<ol class="arabic simple" start="5">
<li><p>Alternatively you can use the tools installed with KDE Craft by adding them to %PATH%:</p></li>
</ol>
<div class="highlight-winbatch notranslate"><div class="highlight"><pre><span></span><span class="k">set</span> <span class="s2">&quot;PATH=C:\CraftRoot\bin;C:\CraftRoot\dev-utils\bin;</span><span class="nv">%PATH%</span><span class="s2">&quot;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>C:CraftRoot is the path used by default by KDE Craft. When you are setting it up you may choose a different folder.</p>
</div>
<ol class="arabic simple" start="6">
<li><p>Create build folder, run cmake, compile and install:</p></li>
</ol>
<div class="highlight-winbatch notranslate"><div class="highlight"><pre><span></span><span class="k">cd</span> <span class="p">&lt;</span>desktop-repo-path&gt;
<span class="k">mkdir</span> build
<span class="k">cd</span> build
cmake .. -G Ninja -DCMAKE_INSTALL_PREFIX=. -DCMAKE_PREFIX_PATH=C:\CraftRoot -DCMAKE_BUILD_TYPE=RelWithDebInfo
cmake --build . --target install
</pre></div>
</div>
<ol class="arabic simple" start="7">
<li><p>Now you can use <a class="reference external" href="https://doc.qt.io/qtcreator">Qt Creator</a> to import the build folder with its configurations to be able to work with the code.</p></li>
</ol>
</section>
<section id="windows-installer-i-e-deployment-build-cross-compile">
<h3>Windows Installer (i.e. Deployment) Build (Cross-Compile)<a class="headerlink" href="#windows-installer-i-e-deployment-build-cross-compile" title="Link to this heading"></a></h3>
<p>Due to the large number of dependencies, building the client installer for Windows
is <strong>currently only officially supported on openSUSE</strong>, by using the MinGW cross compiler.
You can set up any currently supported version of openSUSE in a virtual machine if you do not
have it installed already.</p>
<p>In order to make setup simple, you can use the provided Dockerfile to build your own image.</p>
<ol class="arabic">
<li><p>Assuming you are in the root of the Nextcloud Client’s source tree, you can
build an image from this Dockerfile like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">admin</span><span class="o">/</span><span class="n">win</span><span class="o">/</span><span class="n">docker</span>
<span class="n">docker</span> <span class="n">build</span> <span class="o">.</span> <span class="o">-</span><span class="n">t</span> <span class="n">nextcloud</span><span class="o">-</span><span class="n">client</span><span class="o">-</span><span class="n">win32</span><span class="p">:</span><span class="o">&lt;</span><span class="n">version</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Replace <code class="docutils literal notranslate"><span class="pre">&lt;version&gt;</span></code> by the version of the client you are building, e.g.
latest for the release of the client that this document describes.
If you do not wish to use docker, you can run the commands in <code class="docutils literal notranslate"><span class="pre">RUN</span></code> manually
in a shell, e.g. to create your own build environment in a virtual machine.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Docker images are specific to releases. This one refers to latest.
Newer releases may have different dependencies, and thus require a later
version of the docker image! Always pick the docker image fitting your release
of Nextcloud client!</p>
</div>
</li>
<li><p>From within the source tree Run the docker instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>docker run -v &quot;$PWD:/home/user/client&quot; nextcloud-client-win32:&lt;version&gt; \
   /home/user/client/admin/win/docker/build.sh client/  $(id -u)
</pre></div>
</div>
<p>It will run the build, create an NSIS based installer, as well as run tests.
You will find the resulting binary in an newly created <code class="docutils literal notranslate"><span class="pre">build-win32</span></code> subfolder.</p>
<p>If you do not wish to use docker, and ran the <code class="docutils literal notranslate"><span class="pre">RUN</span></code> commands above in a virtual machine,
you can run the indented commands in the lower section of <code class="docutils literal notranslate"><span class="pre">build.sh</span></code> manually in your
source tree.</p>
</li>
</ol>
<ol class="arabic" start="4">
<li><p>Finally, you should sign the installer to avoid warnings upon installation.
This requires a <a class="reference external" href="https://msdn.microsoft.com/en-us/library/ie/ms537361%28v=vs.85%29.aspx">Microsoft Authenticode</a> Certificate <code class="docutils literal notranslate"><span class="pre">osslsigncode</span></code> to sign the installer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>osslsigncode -pkcs12 $HOME/.codesign/packages.pfx -h sha256 \
          -pass yourpass \
          -n &quot;ACME Client&quot; \
          -i &quot;http://acme.com&quot; \
          -ts &quot;http://timestamp.server/&quot; \
          -in ${unsigned_file} \
          -out ${installer_file}
</pre></div>
</div>
<p>For <code class="docutils literal notranslate"><span class="pre">-in</span></code>, use the URL to the time stamping server provided by your CA along with the Authenticode certificate. Alternatively,
you may use the official Microsoft <code class="docutils literal notranslate"><span class="pre">signtool</span></code> utility on Microsoft Windows.</p>
<p>If you’re familiar with docker, you can use the version of <code class="docutils literal notranslate"><span class="pre">osslsigncode</span></code> that is part of the docker image.</p>
</li>
</ol>
</section>
</section>
<section id="generic-build-instructions">
<span id="id2"></span><h2>Generic Build Instructions<a class="headerlink" href="#generic-build-instructions" title="Link to this heading"></a></h2>
<p>Compared to previous versions, building the desktop sync client has become easier. Unlike
earlier versions, CSync, which is the sync engine library of the client, is now
part of the client source repository and not a separate module.</p>
<p>To build the most up-to-date version of the client:</p>
<ol class="arabic">
<li><p>Clone the latest versions of the client from <a class="reference external" href="http://git-scm.com">Git</a> as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>git://github.com/nextcloud/client.git
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>client
$<span class="w"> </span>git<span class="w"> </span>submodule<span class="w"> </span>update<span class="w"> </span>--init
</pre></div>
</div>
</li>
<li><p>Create the build directory</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>mkdir<span class="w"> </span>client-build
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>client-build
</pre></div>
</div>
</li>
<li><p>Configure the client build</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>cmake<span class="w"> </span>-DCMAKE_BUILD_TYPE<span class="o">=</span><span class="s2">&quot;Debug&quot;</span><span class="w"> </span>..
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You must use absolute paths for the <code class="docutils literal notranslate"><span class="pre">include</span></code> and <code class="docutils literal notranslate"><span class="pre">library</span></code>
directories.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>On macOS, you need to specify <code class="docutils literal notranslate"><span class="pre">-DCMAKE_INSTALL_PREFIX=target</span></code>,
where <code class="docutils literal notranslate"><span class="pre">target</span></code> is a private location, i.e. in parallel to your build
dir by specifying <code class="docutils literal notranslate"><span class="pre">../install</span></code>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>qtkeychain must be compiled with the same prefix e.g <code class="docutils literal notranslate"><span class="pre">CMAKE_INSTALL_PREFIX=/Users/path/to/client/install/</span> <span class="pre">.</span></code></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Example:: <code class="docutils literal notranslate"><span class="pre">cmake</span> <span class="pre">-DCMAKE_PREFIX_PATH=/usr/local/opt/qt6</span> <span class="pre">-DCMAKE_INSTALL_PREFIX=/Users/path/to/client/install/</span></code></p>
</div>
</li>
<li><p>Call <code class="docutils literal notranslate"><span class="pre">make</span></code>.</p>
<p>The Nextcloud binary will appear in the <code class="docutils literal notranslate"><span class="pre">bin</span></code> directory.</p>
</li>
<li><p>(Optional) Call <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">install</span></code> to install the client to the
<code class="docutils literal notranslate"><span class="pre">/usr/local/bin</span></code> directory.</p></li>
</ol>
<p>The following are known cmake parameters:</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">QTKEYCHAIN_LIBRARY=/path/to/qtkeychain.dylib</span> <span class="pre">-DQTKEYCHAIN_INCLUDE_DIR=/path/to/qtkeychain/</span></code>:</dt><dd><p>Used for stored credentials.  When compiling with Qt5, the library is called <code class="docutils literal notranslate"><span class="pre">qt5keychain.dylib.</span></code>
You need to compile QtKeychain with the same Qt version.</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">WITH_DOC=TRUE</span></code>: Creates doc and manpages through running <code class="docutils literal notranslate"><span class="pre">make</span></code>; also adds install statements,
providing the ability to install using <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">install</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CMAKE_PREFIX_PATH=/path/to/Qt6/6.7.0/yourarch/lib/cmake/</span></code>: Builds using Qt6.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CMAKE_INSTALL_PREFIX=path</span></code>: Set an install prefix. This is mandatory on Mac OS</p></li>
</ul>
<section id="address-sanitizer">
<h3>Address Sanitizer<a class="headerlink" href="#address-sanitizer" title="Link to this heading"></a></h3>
<p>You can enable the address sanitizer to detect memory corruptions and other mistakes.
The are the following sanitizers are available:</p>
<ul class="simple">
<li><p>Address Sanitizer</p></li>
<li><p>Leak anitizer</p></li>
<li><p>Memory sanitizer</p></li>
<li><p>Undefined sanitizer</p></li>
<li><p>Threads sanitizer</p></li>
</ul>
<p>You can enable one or more sanitizers through CMake. For example, to
enable the address and the undefined sanitizer, execute CMake like
<code class="docutils literal notranslate"><span class="pre">cmake</span> <span class="pre">..</span> <span class="pre">-D</span> <span class="pre">ECM_ENABLE_SANITIZERS=&quot;address;undefined&quot;</span></code>.
Keep in mind that not all combinations of sanitizers work together, and on some
platforms, not all types of sanitizers are available. For example, on Windows there is
currently only the address sanitizer available. If you are on Windows, you need to
make sure that the linker can find the sanitizer dlls at runtime. If you installed
Visual Studio in the standard location, you could find them in
<strong>C:/ProgramFiles (x86)/Microsoft Visual Studio/2019/Community/VC/Tools/Llvm/x64/lib/clang/10.0.0/lib/windows</strong>.
Make sure you add this location to your path. You may also need to
<a class="reference external" href="https://docs.microsoft.com/en-us/cpp/sanitizers/asan?view=msvc-160#install-the-addresssanitizer">upgrade your Visual Studio version</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you use Visual Studio on Windows, you can enable the
sanitizer if you click on <strong>Manage Configurations</strong>, scroll
down to the section <strong>CMake Command Arguments</strong> and enter then
<code class="docutils literal notranslate"><span class="pre">-D</span> <span class="pre">ECM_ENABLE_SANITIZERS=&quot;address&quot;</span></code> in the text input field below.
After that, click on <strong>Save and generate CMake cache to load variables</strong>
right above the table.</p>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Desktop Clients" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025 Nextcloud GmbH.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          <dd><a href="https://docs.nextcloud.com/server/29/developer_manual">29</a></dd>
        
          <dd><a href="https://docs.nextcloud.com/server/30/developer_manual">30</a></dd>
        
          <dd><a href="https://docs.nextcloud.com/server/31/developer_manual">31</a></dd>
        
          <dd><a href="https://docs.nextcloud.com/server/stable/developer_manual">stable</a></dd>
        
          <dd><a href="https://docs.nextcloud.com/server/latest/developer_manual">latest</a></dd>
        
      </dl>
    </div>
  </div>
<script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>