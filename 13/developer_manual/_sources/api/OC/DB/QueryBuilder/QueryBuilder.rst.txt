.. rst-class:: phpdoctorst

.. role:: php(code)
	:language: php


QueryBuilder
============


.. php:namespace:: OC\DB\QueryBuilder

.. php:class:: QueryBuilder


	:Source:
		`lib/private/DB/QueryBuilder/QueryBuilder.php#58 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L58>`_
	
	:Implements:
		:php:interface:`OCP\\DB\\QueryBuilder\\IQueryBuilder` 
	

Properties
----------

.. php:attr:: protected static lastInsertedTable

	:Source:
		`lib/private/DB/QueryBuilder/QueryBuilder.php#79 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L79>`_
	
	:Type: string 


Methods
-------

.. rst-class:: public

	.. php:method:: public __construct( $connection, $systemConfig, $logger)
	
		.. rst-class:: phpdoc-description
		
			| Initializes a new QueryBuilder\.
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#88 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L88>`_
		
		
		:Parameters:
			* **$connection** (:any:`OC\\DB\\ConnectionAdapter <OC\\DB\\ConnectionAdapter>`)  
			* **$systemConfig** (:any:`OC\\SystemConfig <OC\\SystemConfig>`)  
			* **$logger** (:any:`OCP\\ILogger <OCP\\ILogger>`)  

		
	
	

.. rst-class:: public

	.. php:method:: public automaticTablePrefix( $enabled)
	
		.. rst-class:: phpdoc-description
		
			| Enable/disable automatic prefixing of table names with the oc\_ prefix
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#103 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L103>`_
		
		
		:Parameters:
			* **$enabled** (bool)  If set to true table names will be prefixed with the
			owncloud database prefix automatically.

		
		:Since: 8.2.0 
	
	

.. rst-class:: public

	.. php:method:: public expr()
	
		.. rst-class:: phpdoc-description
		
			| Gets an ExpressionBuilder used for object\-oriented construction of query expressions\.
			
			| This producer method is intended for convenient inline usage\. Example:
			| 
			| <code\>
			|     $qb = $conn\-\>getQueryBuilder\(\)
			|         \-\>select\(\'u\'\)
			|         \-\>from\(\'users\', \'u\'\)
			|         \-\>where\($qb\-\>expr\(\)\-\>eq\(\'u\.id\', 1\)\);
			| </code\>
			| 
			| For more complex expression construction, consider storing the expression
			| builder object in a local variable\.
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#123 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L123>`_
		
		
		:Returns: :any:`\\OCP\\DB\\QueryBuilder\\IExpressionBuilder <OCP\\DB\\QueryBuilder\\IExpressionBuilder>` 
	
	

.. rst-class:: public

	.. php:method:: public func()
	
		.. rst-class:: phpdoc-description
		
			| Gets an FunctionBuilder used for object\-oriented construction of query functions\.
			
			| This producer method is intended for convenient inline usage\. Example:
			| 
			| <code\>
			|     $qb = $conn\-\>getQueryBuilder\(\)
			|         \-\>select\(\'u\'\)
			|         \-\>from\(\'users\', \'u\'\)
			|         \-\>where\($qb\-\>fun\(\)\-\>md5\(\'u\.id\'\)\);
			| </code\>
			| 
			| For more complex function construction, consider storing the function
			| builder object in a local variable\.
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#156 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L156>`_
		
		
		:Returns: :any:`\\OCP\\DB\\QueryBuilder\\IFunctionBuilder <OCP\\DB\\QueryBuilder\\IFunctionBuilder>` 
	
	

.. rst-class:: public

	.. php:method:: public getType()
	
		.. rst-class:: phpdoc-description
		
			| Gets the type of the currently built query\.
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#175 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L175>`_
		
		
		:Returns: int 
	
	

.. rst-class:: public

	.. php:method:: public getConnection()
	
		.. rst-class:: phpdoc-description
		
			| Gets the associated DBAL Connection for this query builder\.
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#184 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L184>`_
		
		
		:Returns: :any:`\\OCP\\IDBConnection <OCP\\IDBConnection>` 
	
	

.. rst-class:: public

	.. php:method:: public getState()
	
		.. rst-class:: phpdoc-description
		
			| Gets the state of this query builder instance\.
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#193 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L193>`_
		
		
		:Returns: int Either QueryBuilder::STATE\_DIRTY or QueryBuilder::STATE\_CLEAN\.
	
	

.. rst-class:: public

	.. php:method:: public execute()
	
		.. rst-class:: phpdoc-description
		
			| Executes this query using the bound parameters and their types\.
			
			| Uses \{@see \\OC\\DB\\QueryBuilder\\Connection::executeQuery\} for select statements and \{@see \\OC\\DB\\QueryBuilder\\Connection::executeUpdate\}
			| for insert, update and delete statements\.
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#205 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L205>`_
		
		
		:Returns: :any:`\\OCP\\DB\\IResult <OCP\\DB\\IResult>` | int 
	
	

.. rst-class:: public

	.. php:method:: public executeQuery()
	
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#294 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L294>`_
		
		
	
	

.. rst-class:: public deprecated

	.. php:method:: public executeUpdate()
	
		.. rst-class:: phpdoc-description
		
			| Monkey\-patched compatibility layer for apps that were adapted for Nextcloud 22 before
			| the first beta, where executeStatement was named executeUpdate\.
			
			| Static analysis should catch those misuses, but until then let\'s try to keep things
			| running\.
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#323 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L323>`_
		
		
		:Deprecated:  
	
	

.. rst-class:: public

	.. php:method:: public executeStatement()
	
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#327 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L327>`_
		
		
	
	

.. rst-class:: public

	.. php:method:: public getSQL()
	
		.. rst-class:: phpdoc-description
		
			| Gets the complete SQL string formed by the current specifications of this QueryBuilder\.
			
			| <code\>
			|     $qb = $conn\-\>getQueryBuilder\(\)
			|         \-\>select\(\'u\'\)
			|         \-\>from\(\'User\', \'u\'\)
			|     echo $qb\-\>getSQL\(\); // SELECT u FROM User u
			| </code\>
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#358 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L358>`_
		
		
		:Returns: string The SQL query string\.
	
	

.. rst-class:: public

	.. php:method:: public setParameter( $key, $value, $type=null)
	
		.. rst-class:: phpdoc-description
		
			| Sets a query parameter for the query being constructed\.
			
			| <code\>
			|     $qb = $conn\-\>getQueryBuilder\(\)
			|         \-\>select\(\'u\'\)
			|         \-\>from\(\'users\', \'u\'\)
			|         \-\>where\(\'u\.id = :user\_id\'\)
			|         \-\>setParameter\(\':user\_id\', 1\);
			| </code\>
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#379 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L379>`_
		
		
		:Parameters:
			* **$key** (string | int)  The parameter position or name.
			* **$value** (mixed)  The parameter value.
			* **$type** (string | null | int)  One of the IQueryBuilder::PARAM_* constants.

		
		:Returns: $this This QueryBuilder instance\.
	
	

.. rst-class:: public

	.. php:method:: public setParameters( $params, $types=\[\])
	
		.. rst-class:: phpdoc-description
		
			| Sets a collection of query parameters for the query being constructed\.
			
			| <code\>
			|     $qb = $conn\-\>getQueryBuilder\(\)
			|         \-\>select\(\'u\'\)
			|         \-\>from\(\'users\', \'u\'\)
			|         \-\>where\(\'u\.id = :user\_id1 OR u\.id = :user\_id2\'\)
			|         \-\>setParameters\(array\(
			|             \':user\_id1\' =\> 1,
			|             \':user\_id2\' =\> 2
			|         \)\);
			| </code\>
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#404 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L404>`_
		
		
		:Parameters:
			* **$params** (array)  The query parameters to set.
			* **$types** (array)  The query parameters types to set.

		
		:Returns: $this This QueryBuilder instance\.
	
	

.. rst-class:: public

	.. php:method:: public getParameters()
	
		.. rst-class:: phpdoc-description
		
			| Gets all defined query parameters for the query being constructed indexed by parameter index or name\.
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#415 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L415>`_
		
		
		:Returns: array The currently defined query parameters indexed by parameter index or name\.
	
	

.. rst-class:: public

	.. php:method:: public getParameter( $key)
	
		.. rst-class:: phpdoc-description
		
			| Gets a \(previously set\) query parameter of the query being constructed\.
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#426 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L426>`_
		
		
		:Parameters:
			* **$key** (mixed)  The key (index or name) of the bound parameter.

		
		:Returns: mixed The value of the bound parameter\.
	
	

.. rst-class:: public

	.. php:method:: public getParameterTypes()
	
		.. rst-class:: phpdoc-description
		
			| Gets all defined query parameter types for the query being constructed indexed by parameter index or name\.
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#435 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L435>`_
		
		
		:Returns: array The currently defined query parameter types indexed by parameter index or name\.
	
	

.. rst-class:: public

	.. php:method:: public getParameterType( $key)
	
		.. rst-class:: phpdoc-description
		
			| Gets a \(previously set\) query parameter type of the query being constructed\.
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#446 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L446>`_
		
		
		:Parameters:
			* **$key** (mixed)  The key (index or name) of the bound parameter type.

		
		:Returns: mixed The value of the bound parameter type\.
	
	

.. rst-class:: public

	.. php:method:: public setFirstResult( $firstResult)
	
		.. rst-class:: phpdoc-description
		
			| Sets the position of the first result to retrieve \(the "offset"\)\.
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#457 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L457>`_
		
		
		:Parameters:
			* **$firstResult** (int)  The first result to return.

		
		:Returns: $this This QueryBuilder instance\.
	
	

.. rst-class:: public

	.. php:method:: public getFirstResult()
	
		.. rst-class:: phpdoc-description
		
			| Gets the position of the first result the query object was set to retrieve \(the "offset"\)\.
			
			| Returns NULL if \{@link setFirstResult\} was not applied to this QueryBuilder\.
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#469 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L469>`_
		
		
		:Returns: int The position of the first result\.
	
	

.. rst-class:: public

	.. php:method:: public setMaxResults( $maxResults)
	
		.. rst-class:: phpdoc-description
		
			| Sets the maximum number of results to retrieve \(the "limit"\)\.
			
			| NOTE: Setting max results to "0" will cause mixed behaviour\. While most
			| of the databases will just return an empty result set, Oracle will return
			| all entries\.
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#484 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L484>`_
		
		
		:Parameters:
			* **$maxResults** (int)  The maximum number of results to retrieve.

		
		:Returns: $this This QueryBuilder instance\.
	
	

.. rst-class:: public

	.. php:method:: public getMaxResults()
	
		.. rst-class:: phpdoc-description
		
			| Gets the maximum number of results the query object was set to retrieve \(the "limit"\)\.
			
			| Returns NULL if \{@link setMaxResults\} was not applied to this query builder\.
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#496 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L496>`_
		
		
		:Returns: int | null The maximum number of results\.
	
	

.. rst-class:: public

	.. php:method:: public select( ...$selects)
	
		.. rst-class:: phpdoc-description
		
			| Specifies an item that is to be returned in the query result\.
			
			| Replaces any previously specified selections, if any\.
			| 
			| <code\>
			|     $qb = $conn\-\>getQueryBuilder\(\)
			|         \-\>select\(\'u\.id\', \'p\.id\'\)
			|         \-\>from\(\'users\', \'u\'\)
			|         \-\>leftJoin\(\'u\', \'phonenumbers\', \'p\', \'u\.id = p\.user\_id\'\);
			| </code\>
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#515 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L515>`_
		
		
		:Parameters:
			* **$selects** (mixed)  The selection expressions.
			
			'@return $this This QueryBuilder instance.

		
	
	

.. rst-class:: public

	.. php:method:: public selectAlias( $select, $alias)
	
		.. rst-class:: phpdoc-description
		
			| Specifies an item that is to be returned with a different name in the query result\.
			
			| <code\>
			|     $qb = $conn\-\>getQueryBuilder\(\)
			|         \-\>selectAlias\(\'u\.id\', \'user\_id\'\)
			|         \-\>from\(\'users\', \'u\'\)
			|         \-\>leftJoin\(\'u\', \'phonenumbers\', \'p\', \'u\.id = p\.user\_id\'\);
			| </code\>
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#542 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L542>`_
		
		
		:Parameters:
			* **$select** (mixed)  The selection expressions.
			* **$alias** (string)  The column alias used in the constructed query.

		
		:Returns: $this This QueryBuilder instance\.
	
	

.. rst-class:: public

	.. php:method:: public selectDistinct( $select)
	
		.. rst-class:: phpdoc-description
		
			| Specifies an item that is to be returned uniquely in the query result\.
			
			| <code\>
			|     $qb = $conn\-\>getQueryBuilder\(\)
			|         \-\>selectDistinct\(\'type\'\)
			|         \-\>from\(\'users\'\);
			| </code\>
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#563 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L563>`_
		
		
		:Parameters:
			* **$select** (mixed)  The selection expressions.

		
		:Returns: $this This QueryBuilder instance\.
	
	

.. rst-class:: public

	.. php:method:: public addSelect( ...$selects)
	
		.. rst-class:: phpdoc-description
		
			| Adds an item that is to be returned in the query result\.
			
			| <code\>
			|     $qb = $conn\-\>getQueryBuilder\(\)
			|         \-\>select\(\'u\.id\'\)
			|         \-\>addSelect\(\'p\.id\'\)
			|         \-\>from\(\'users\', \'u\'\)
			|         \-\>leftJoin\(\'u\', \'phonenumbers\', \'u\.id = p\.user\_id\'\);
			| </code\>
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#592 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L592>`_
		
		
		:Parameters:
			* **$selects** (mixed)  The selection expression.

		
		:Returns: $this This QueryBuilder instance\.
	
	

.. rst-class:: public

	.. php:method:: public delete( $delete=null, $alias=null)
	
		.. rst-class:: phpdoc-description
		
			| Turns the query being built into a bulk delete query that ranges over
			| a certain table\.
			
			| <code\>
			|     $qb = $conn\-\>getQueryBuilder\(\)
			|         \-\>delete\(\'users\', \'u\'\)
			|         \-\>where\(\'u\.id = :user\_id\'\);
			|         \-\>setParameter\(\':user\_id\', 1\);
			| </code\>
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#620 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L620>`_
		
		
		:Parameters:
			* **$delete** (string)  The table whose rows are subject to the deletion.
			* **$alias** (string)  The table alias used in the constructed query.

		
		:Returns: $this This QueryBuilder instance\.
	
	

.. rst-class:: public

	.. php:method:: public update( $update=null, $alias=null)
	
		.. rst-class:: phpdoc-description
		
			| Turns the query being built into a bulk update query that ranges over
			| a certain table
			
			| <code\>
			|     $qb = $conn\-\>getQueryBuilder\(\)
			|         \-\>update\(\'users\', \'u\'\)
			|         \-\>set\(\'u\.password\', md5\(\'password\'\)\)
			|         \-\>where\(\'u\.id = ?\'\);
			| </code\>
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#645 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L645>`_
		
		
		:Parameters:
			* **$update** (string)  The table whose rows are subject to the update.
			* **$alias** (string)  The table alias used in the constructed query.

		
		:Returns: $this This QueryBuilder instance\.
	
	

.. rst-class:: public

	.. php:method:: public insert( $insert=null)
	
		.. rst-class:: phpdoc-description
		
			| Turns the query being built into an insert query that inserts into
			| a certain table
			
			| <code\>
			|     $qb = $conn\-\>getQueryBuilder\(\)
			|         \-\>insert\(\'users\'\)
			|         \-\>values\(
			|             array\(
			|                 \'name\' =\> \'?\',
			|                 \'password\' =\> \'?\'
			|             \)
			|         \);
			| </code\>
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#673 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L673>`_
		
		
		:Parameters:
			* **$insert** (string)  The table into which the rows should be inserted.

		
		:Returns: $this This QueryBuilder instance\.
	
	

.. rst-class:: public

	.. php:method:: public from( $from, $alias=null)
	
		.. rst-class:: phpdoc-description
		
			| Creates and adds a query root corresponding to the table identified by the
			| given alias, forming a cartesian product with any existing query roots\.
			
			| <code\>
			|     $qb = $conn\-\>getQueryBuilder\(\)
			|         \-\>select\(\'u\.id\'\)
			|         \-\>from\(\'users\', \'u\'\)
			| </code\>
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#698 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L698>`_
		
		
		:Parameters:
			* **$from** (string)  The table.
			* **$alias** (string | null)  The alias of the table.

		
		:Returns: $this This QueryBuilder instance\.
	
	

.. rst-class:: public

	.. php:method:: public join( $fromAlias, $join, $alias, $condition=null)
	
		.. rst-class:: phpdoc-description
		
			| Creates and adds a join to the query\.
			
			| <code\>
			|     $qb = $conn\-\>getQueryBuilder\(\)
			|         \-\>select\(\'u\.name\'\)
			|         \-\>from\(\'users\', \'u\'\)
			|         \-\>join\(\'u\', \'phonenumbers\', \'p\', \'p\.is\_primary = 1\'\);
			| </code\>
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#724 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L724>`_
		
		
		:Parameters:
			* **$fromAlias** (string)  The alias that points to a from clause.
			* **$join** (string)  The table name to join.
			* **$alias** (string)  The alias of the join table.
			* **$condition** (string | :any:`\\OCP\\DB\\QueryBuilder\\ICompositeExpression <OCP\\DB\\QueryBuilder\\ICompositeExpression>` | null)  The condition for the join.

		
		:Returns: $this This QueryBuilder instance\.
	
	

.. rst-class:: public

	.. php:method:: public innerJoin( $fromAlias, $join, $alias, $condition=null)
	
		.. rst-class:: phpdoc-description
		
			| Creates and adds a join to the query\.
			
			| <code\>
			|     $qb = $conn\-\>getQueryBuilder\(\)
			|         \-\>select\(\'u\.name\'\)
			|         \-\>from\(\'users\', \'u\'\)
			|         \-\>innerJoin\(\'u\', \'phonenumbers\', \'p\', \'p\.is\_primary = 1\'\);
			| </code\>
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#752 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L752>`_
		
		
		:Parameters:
			* **$fromAlias** (string)  The alias that points to a from clause.
			* **$join** (string)  The table name to join.
			* **$alias** (string)  The alias of the join table.
			* **$condition** (string | :any:`\\OCP\\DB\\QueryBuilder\\ICompositeExpression <OCP\\DB\\QueryBuilder\\ICompositeExpression>` | null)  The condition for the join.

		
		:Returns: $this This QueryBuilder instance\.
	
	

.. rst-class:: public

	.. php:method:: public leftJoin( $fromAlias, $join, $alias, $condition=null)
	
		.. rst-class:: phpdoc-description
		
			| Creates and adds a left join to the query\.
			
			| <code\>
			|     $qb = $conn\-\>getQueryBuilder\(\)
			|         \-\>select\(\'u\.name\'\)
			|         \-\>from\(\'users\', \'u\'\)
			|         \-\>leftJoin\(\'u\', \'phonenumbers\', \'p\', \'p\.is\_primary = 1\'\);
			| </code\>
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#780 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L780>`_
		
		
		:Parameters:
			* **$fromAlias** (string)  The alias that points to a from clause.
			* **$join** (string)  The table name to join.
			* **$alias** (string)  The alias of the join table.
			* **$condition** (string | :any:`\\OCP\\DB\\QueryBuilder\\ICompositeExpression <OCP\\DB\\QueryBuilder\\ICompositeExpression>` | null)  The condition for the join.

		
		:Returns: $this This QueryBuilder instance\.
	
	

.. rst-class:: public

	.. php:method:: public rightJoin( $fromAlias, $join, $alias, $condition=null)
	
		.. rst-class:: phpdoc-description
		
			| Creates and adds a right join to the query\.
			
			| <code\>
			|     $qb = $conn\-\>getQueryBuilder\(\)
			|         \-\>select\(\'u\.name\'\)
			|         \-\>from\(\'users\', \'u\'\)
			|         \-\>rightJoin\(\'u\', \'phonenumbers\', \'p\', \'p\.is\_primary = 1\'\);
			| </code\>
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#808 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L808>`_
		
		
		:Parameters:
			* **$fromAlias** (string)  The alias that points to a from clause.
			* **$join** (string)  The table name to join.
			* **$alias** (string)  The alias of the join table.
			* **$condition** (string | :any:`\\OCP\\DB\\QueryBuilder\\ICompositeExpression <OCP\\DB\\QueryBuilder\\ICompositeExpression>` | null)  The condition for the join.

		
		:Returns: $this This QueryBuilder instance\.
	
	

.. rst-class:: public

	.. php:method:: public set( $key, $value)
	
		.. rst-class:: phpdoc-description
		
			| Sets a new value for a column in a bulk update query\.
			
			| <code\>
			|     $qb = $conn\-\>getQueryBuilder\(\)
			|         \-\>update\(\'users\', \'u\'\)
			|         \-\>set\(\'u\.password\', md5\(\'password\'\)\)
			|         \-\>where\(\'u\.id = ?\'\);
			| </code\>
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#834 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L834>`_
		
		
		:Parameters:
			* **$key** (string)  The column to set.
			* **$value** (:any:`OCP\\DB\\QueryBuilder\\ILiteral <OCP\\DB\\QueryBuilder\\ILiteral>` | :any:`\\OCP\\DB\\QueryBuilder\\IParameter <OCP\\DB\\QueryBuilder\\IParameter>` | :any:`\\OCP\\DB\\QueryBuilder\\IQueryFunction <OCP\\DB\\QueryBuilder\\IQueryFunction>` | string)  The value, expression, placeholder, etc.

		
		:Returns: $this This QueryBuilder instance\.
	
	

.. rst-class:: public

	.. php:method:: public where( ...$predicates)
	
		.. rst-class:: phpdoc-description
		
			| Specifies one or more restrictions to the query result\.
			
			| Replaces any previously specified restrictions, if any\.
			| 
			| <code\>
			|     $qb = $conn\-\>getQueryBuilder\(\)
			|         \-\>select\(\'u\.name\'\)
			|         \-\>from\(\'users\', \'u\'\)
			|         \-\>where\(\'u\.id = ?\'\);
			| 
			|     // You can optionally programatically build and/or expressions
			|     $qb = $conn\-\>getQueryBuilder\(\);
			| 
			|     $or = $qb\-\>expr\(\)\-\>orx\(\);
			|     $or\-\>add\($qb\-\>expr\(\)\-\>eq\(\'u\.id\', 1\)\);
			|     $or\-\>add\($qb\-\>expr\(\)\-\>eq\(\'u\.id\', 2\)\);
			| 
			|     $qb\-\>update\(\'users\', \'u\'\)
			|         \-\>set\(\'u\.password\', md5\(\'password\'\)\)
			|         \-\>where\($or\);
			| </code\>
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#869 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L869>`_
		
		
		:Parameters:
			* **$predicates** (mixed)  The restriction predicates.

		
		:Returns: $this This QueryBuilder instance\.
	
	

.. rst-class:: public

	.. php:method:: public andWhere( ...$where)
	
		.. rst-class:: phpdoc-description
		
			| Adds one or more restrictions to the query results, forming a logical
			| conjunction with any previously specified restrictions\.
			
			| <code\>
			|     $qb = $conn\-\>getQueryBuilder\(\)
			|         \-\>select\(\'u\'\)
			|         \-\>from\(\'users\', \'u\'\)
			|         \-\>where\(\'u\.username LIKE ?\'\)
			|         \-\>andWhere\(\'u\.is\_active = 1\'\);
			| </code\>
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#896 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L896>`_
		
		
		:Parameters:
			* **$where** (mixed)  The query restrictions.

		
		:Returns: $this This QueryBuilder instance\.
		:See: :any:`\\OC\\DB\\QueryBuilder\\where\(\) <OC\\DB\\QueryBuilder\\where\(\)>` 
	
	

.. rst-class:: public

	.. php:method:: public orWhere( ...$where)
	
		.. rst-class:: phpdoc-description
		
			| Adds one or more restrictions to the query results, forming a logical
			| disjunction with any previously specified restrictions\.
			
			| <code\>
			|     $qb = $conn\-\>getQueryBuilder\(\)
			|         \-\>select\(\'u\.name\'\)
			|         \-\>from\(\'users\', \'u\'\)
			|         \-\>where\(\'u\.id = 1\'\)
			|         \-\>orWhere\(\'u\.id = 2\'\);
			| </code\>
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#923 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L923>`_
		
		
		:Parameters:
			* **$where** (mixed)  The WHERE statement.

		
		:Returns: $this This QueryBuilder instance\.
		:See: :any:`\\OC\\DB\\QueryBuilder\\where\(\) <OC\\DB\\QueryBuilder\\where\(\)>` 
	
	

.. rst-class:: public

	.. php:method:: public groupBy( ...$groupBys)
	
		.. rst-class:: phpdoc-description
		
			| Specifies a grouping over the results of the query\.
			
			| Replaces any previously specified groupings, if any\.
			| 
			| <code\>
			|     $qb = $conn\-\>getQueryBuilder\(\)
			|         \-\>select\(\'u\.name\'\)
			|         \-\>from\(\'users\', \'u\'\)
			|         \-\>groupBy\(\'u\.id\'\);
			| </code\>
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#947 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L947>`_
		
		
		:Parameters:
			* **$groupBys** (mixed)  The grouping expression.

		
		:Returns: $this This QueryBuilder instance\.
	
	

.. rst-class:: public

	.. php:method:: public addGroupBy( ...$groupBys)
	
		.. rst-class:: phpdoc-description
		
			| Adds a grouping expression to the query\.
			
			| <code\>
			|     $qb = $conn\-\>getQueryBuilder\(\)
			|         \-\>select\(\'u\.name\'\)
			|         \-\>from\(\'users\', \'u\'\)
			|         \-\>groupBy\(\'u\.lastLogin\'\);
			|         \-\>addGroupBy\(\'u\.createdAt\'\)
			| </code\>
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#975 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L975>`_
		
		
		:Parameters:
			
			
		
		:Returns: $this This QueryBuilder instance\.
	
	

.. rst-class:: public

	.. php:method:: public setValue( $column, $value)
	
		.. rst-class:: phpdoc-description
		
			| Sets a value for a column in an insert query\.
			
			| <code\>
			|     $qb = $conn\-\>getQueryBuilder\(\)
			|         \-\>insert\(\'users\'\)
			|         \-\>values\(
			|             array\(
			|                 \'name\' =\> \'?\'
			|             \)
			|         \)
			|         \-\>setValue\(\'password\', \'?\'\);
			| </code\>
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#1007 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L1007>`_
		
		
		:Parameters:
			* **$column** (string)  The column into which the value should be inserted.
			* **$value** (:any:`OCP\\DB\\QueryBuilder\\IParameter <OCP\\DB\\QueryBuilder\\IParameter>` | string)  The value that should be inserted into the column.

		
		:Returns: $this This QueryBuilder instance\.
	
	

.. rst-class:: public

	.. php:method:: public values( $values)
	
		.. rst-class:: phpdoc-description
		
			| Specifies values for an insert query indexed by column names\.
			
			| Replaces any previous values, if any\.
			| 
			| <code\>
			|     $qb = $conn\-\>getQueryBuilder\(\)
			|         \-\>insert\(\'users\'\)
			|         \-\>values\(
			|             array\(
			|                 \'name\' =\> \'?\',
			|                 \'password\' =\> \'?\'
			|             \)
			|         \);
			| </code\>
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#1035 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L1035>`_
		
		
		:Parameters:
			* **$values** (array)  The values to specify for the insert query indexed by column names.

		
		:Returns: $this This QueryBuilder instance\.
	
	

.. rst-class:: public

	.. php:method:: public having( ...$having)
	
		.. rst-class:: phpdoc-description
		
			| Specifies a restriction over the groups of the query\.
			
			| Replaces any previous having restrictions, if any\.
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#1054 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L1054>`_
		
		
		:Parameters:
			* **$having** (mixed)  The restriction over the groups.

		
		:Returns: $this This QueryBuilder instance\.
	
	

.. rst-class:: public

	.. php:method:: public andHaving( ...$having)
	
		.. rst-class:: phpdoc-description
		
			| Adds a restriction over the groups of the query, forming a logical
			| conjunction with any existing having restrictions\.
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#1071 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L1071>`_
		
		
		:Parameters:
			* **$having** (mixed)  The restriction to append.

		
		:Returns: $this This QueryBuilder instance\.
	
	

.. rst-class:: public

	.. php:method:: public orHaving( ...$having)
	
		.. rst-class:: phpdoc-description
		
			| Adds a restriction over the groups of the query, forming a logical
			| disjunction with any existing having restrictions\.
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#1088 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L1088>`_
		
		
		:Parameters:
			* **$having** (mixed)  The restriction to add.

		
		:Returns: $this This QueryBuilder instance\.
	
	

.. rst-class:: public

	.. php:method:: public orderBy( $sort, $order=null)
	
		.. rst-class:: phpdoc-description
		
			| Specifies an ordering for the query results\.
			
			| Replaces any previously specified orderings, if any\.
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#1106 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L1106>`_
		
		
		:Parameters:
			* **$sort** (string)  The ordering expression.
			* **$order** (string)  The ordering direction.

		
		:Returns: $this This QueryBuilder instance\.
	
	

.. rst-class:: public

	.. php:method:: public addOrderBy( $sort, $order=null)
	
		.. rst-class:: phpdoc-description
		
			| Adds an ordering to the query results\.
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#1123 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L1123>`_
		
		
		:Parameters:
			* **$sort** (string)  The ordering expression.
			* **$order** (string)  The ordering direction.

		
		:Returns: $this This QueryBuilder instance\.
	
	

.. rst-class:: public

	.. php:method:: public getQueryPart( $queryPartName)
	
		.. rst-class:: phpdoc-description
		
			| Gets a query part by its name\.
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#1139 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L1139>`_
		
		
		:Parameters:
			* **$queryPartName** (string)  

		
		:Returns: mixed 
	
	

.. rst-class:: public

	.. php:method:: public getQueryParts()
	
		.. rst-class:: phpdoc-description
		
			| Gets all query parts\.
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#1148 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L1148>`_
		
		
		:Returns: array 
	
	

.. rst-class:: public

	.. php:method:: public resetQueryParts( $queryPartNames=null)
	
		.. rst-class:: phpdoc-description
		
			| Resets SQL parts\.
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#1159 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L1159>`_
		
		
		:Parameters:
			* **$queryPartNames** (array | null)  

		
		:Returns: $this This QueryBuilder instance\.
	
	

.. rst-class:: public

	.. php:method:: public resetQueryPart( $queryPartName)
	
		.. rst-class:: phpdoc-description
		
			| Resets a single SQL part\.
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#1172 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L1172>`_
		
		
		:Parameters:
			* **$queryPartName** (string)  

		
		:Returns: $this This QueryBuilder instance\.
	
	

.. rst-class:: public

	.. php:method:: public createNamedParameter( $value, $type=\\OCP\\DB\\QueryBuilder\\IQueryBuilder::PARAM\_STR, $placeHolder=null)
	
		.. rst-class:: phpdoc-description
		
			| Creates a new named parameter and bind the value $value to it\.
			
			| This method provides a shortcut for PDOStatement::bindValue
			| when using prepared statements\.
			| 
			| The parameter $value specifies the value that you want to bind\. If
			| $placeholder is not provided bindValue\(\) will automatically create a
			| placeholder for you\. An automatic placeholder will be of the name
			| \':dcValue1\', \':dcValue2\' etc\.
			| 
			| For more information see \{@link https://www\.php\.net/pdostatement\-bindparam\}
			| 
			| Example:
			| <code\>
			| $value = 2;
			| $q\-\>eq\( \'id\', $q\-\>bindValue\( $value \) \);
			| $stmt = $q\-\>executeQuery\(\); // executed with \'id = 2\'
			| </code\>
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#1207 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L1207>`_
		
		
		:Parameters:
			* **$value** (mixed)  
			* **$type** (mixed)  
			* **$placeHolder** (string)  The name to bind with. The string must start with a colon ':'.

		
		:License: New BSD License
		:Returns: :any:`\\OCP\\DB\\QueryBuilder\\IParameter <OCP\\DB\\QueryBuilder\\IParameter>` the placeholder name used\.
	
	

.. rst-class:: public

	.. php:method:: public createPositionalParameter( $value, $type=\\OCP\\DB\\QueryBuilder\\IQueryBuilder::PARAM\_STR)
	
		.. rst-class:: phpdoc-description
		
			| Creates a new positional parameter and bind the given value to it\.
			
			| Attention: If you are using positional parameters with the query builder you have
			| to be very careful to bind all parameters in the order they appear in the SQL
			| statement , otherwise they get bound in the wrong order which can lead to serious
			| bugs in your code\.
			| 
			| Example:
			| <code\>
			|  $qb = $conn\-\>getQueryBuilder\(\);
			|  $qb\-\>select\(\'u\.\*\'\)
			|     \-\>from\(\'users\', \'u\'\)
			|     \-\>where\(\'u\.username = \' \. $qb\-\>createPositionalParameter\(\'Foo\', IQueryBuilder::PARAM\_STR\)\)
			|     \-\>orWhere\(\'u\.username = \' \. $qb\-\>createPositionalParameter\(\'Bar\', IQueryBuilder::PARAM\_STR\)\)
			| </code\>
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#1233 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L1233>`_
		
		
		:Parameters:
			* **$value** (mixed)  
			* **$type** (int)  

		
		:Returns: :any:`\\OCP\\DB\\QueryBuilder\\IParameter <OCP\\DB\\QueryBuilder\\IParameter>` 
	
	

.. rst-class:: public

	.. php:method:: public createParameter( $name)
	
		.. rst-class:: phpdoc-description
		
			| Creates a new parameter
			
			| Example:
			| <code\>
			|  $qb = $conn\-\>getQueryBuilder\(\);
			|  $qb\-\>select\(\'u\.\*\'\)
			|     \-\>from\(\'users\', \'u\'\)
			|     \-\>where\(\'u\.username = \' \. $qb\-\>createParameter\(\'name\'\)\)
			|     \-\>setParameter\(\'name\', \'Bar\', IQueryBuilder::PARAM\_STR\)\)
			| </code\>
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#1253 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L1253>`_
		
		
		:Parameters:
			* **$name** (string)  

		
		:Returns: :any:`\\OCP\\DB\\QueryBuilder\\IParameter <OCP\\DB\\QueryBuilder\\IParameter>` 
	
	

.. rst-class:: public

	.. php:method:: public createFunction( $call)
	
		.. rst-class:: phpdoc-description
		
			| Creates a new function
			
			| Attention: Column names inside the call have to be quoted before hand
			| 
			| Example:
			| <code\>
			|  $qb = $conn\-\>getQueryBuilder\(\);
			|  $qb\-\>select\($qb\-\>createFunction\(\'COUNT\(\*\)\'\)\)
			|     \-\>from\(\'users\', \'u\'\)
			|  echo $qb\-\>getSQL\(\); // SELECT COUNT\(\*\) FROM \`users\` u
			| </code\>
			| <code\>
			|  $qb = $conn\-\>getQueryBuilder\(\);
			|  $qb\-\>select\($qb\-\>createFunction\(\'COUNT\(\`column\`\)\'\)\)
			|     \-\>from\(\'users\', \'u\'\)
			|  echo $qb\-\>getSQL\(\); // SELECT COUNT\(\`column\`\) FROM \`users\` u
			| </code\>
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#1280 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L1280>`_
		
		
		:Parameters:
			* **$call** (string)  

		
		:Returns: :any:`\\OCP\\DB\\QueryBuilder\\IQueryFunction <OCP\\DB\\QueryBuilder\\IQueryFunction>` 
	
	

.. rst-class:: public

	.. php:method:: public getLastInsertId()
	
		.. rst-class:: phpdoc-description
		
			| Used to get the id of the last inserted element
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#1289 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L1289>`_
		
		
		:Returns: int 
		:Throws: :any:`\\BadMethodCallException <BadMethodCallException>` When being called before an insert query has been run\.
	
	

.. rst-class:: public

	.. php:method:: public getTableName( $table)
	
		.. rst-class:: phpdoc-description
		
			| Returns the table name quoted and with database prefix as needed by the implementation
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#1305 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L1305>`_
		
		
		:Parameters:
			* **$table** (string)  

		
		:Returns: string 
	
	

.. rst-class:: protected

	.. php:method:: protected prefixTableName( $table)
	
		.. rst-class:: phpdoc-description
		
			| Returns the table name with database prefix as needed by the implementation
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#1320 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L1320>`_
		
		
		:Parameters:
			* **$table** (string)  

		
		:Returns: string 
	
	

.. rst-class:: public

	.. php:method:: public getColumnName( $column, $tableAlias="")
	
		.. rst-class:: phpdoc-description
		
			| Returns the column name quoted and with table alias prefix as needed by the implementation
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#1335 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L1335>`_
		
		
		:Parameters:
			* **$column** (string)  
			* **$tableAlias** (string)  

		
		:Returns: string 
	
	

.. rst-class:: public

	.. php:method:: public quoteAlias( $alias)
	
		.. rst-class:: phpdoc-description
		
			| Returns the column name quoted and with table alias prefix as needed by the implementation
			
		
		:Source:
			`lib/private/DB/QueryBuilder/QueryBuilder.php#1349 <https://github.com/nextcloud/server/blob/stable13/lib/private/DB/QueryBuilder/QueryBuilder.php#L1349>`_
		
		
		:Parameters:
			* **$alias** (string)  

		
		:Returns: string 
	
	

